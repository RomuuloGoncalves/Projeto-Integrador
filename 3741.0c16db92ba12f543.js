"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[3741],{3741:(j,g,t)=>{t.r(g),t.d(g,{CodigoArduinoPageModule:()=>E});var p=t(177),h=t(4341),u=t(8974),l=t(1671),o=t(4438),C=t(2906),m=t(8397),f=t(8570),A=t(3427),v=t(2595);const P=[{path:"",component:(()=>{var n;class a{constructor(e,i,s,r){this.Arduino=e,this.Toast=i,this.Usuario=s,this.route=r,this.loading=!1,this.arduinos=[],this.nome_usuario=this.Usuario.nome_usuario,this.id_usuario=this.Usuario.id_usuario,this.quantidade_arduinos=0,this.generatedCode=""}ngOnInit(){this.route.params.subscribe(e=>{this.id_arduino=e.id_arduino}),this.listagemArduino(this.id_arduino),console.log(this.id_arduino)}listagemArduino(e){this.Arduino.listarArduinoSensor(e).subscribe(i=>{console.log("arduinos",i),this.arduinos=i,this.loading=!1,this.quantidade_arduinos=this.arduinos.length,this.Toast.mostrarToast("success","Listagem dos ardu\xednos conclu\xedda"),this.generateArduinoCode()},i=>{console.error("Erro ao cadastrar os dados:",i),this.loading=!1,this.Toast.mostrarToast("danger","Algo deu errado!")})}generateArduinoCode(){let e='\n#include <WiFiClient.h>\n#include <WiFi.h>\n#include <HTTPClient.h>\n#include <ArduinoJson.h>\n\nconst char* ssid = "your-ssid";\nconst char* password = "your-password";\nconst char* serverAddress = "https://amused-hopelessly-tetra.ngrok-free.app/Projeto-Integrador/System";\n\n';this.arduinos.forEach(i=>{i.sensores.forEach(s=>{const r=s.nome.replace(/\s+/g,"_").toUpperCase();e+=`#define ${r}_PIN ${s.pino}\n`})}),e+='\nvoid setup() {\n  Serial.begin(115200);\n  Serial.println("Hello, ESP32!");\n\n  WiFi.begin(ssid, password);\n  while (WiFi.status() != WL_CONNECTED) {\n    delay(100);\n    Serial.print(".");\n  }\n  Serial.println("Connected to WiFi");\n',this.arduinos.forEach(i=>{i.sensores.forEach(s=>{const r=s.nome.replace(/\s+/g,"_").toUpperCase();e+=`  pinMode(${r}_PIN, INPUT);\n`})}),e+='}\nvoid loop() {\n  if (WiFi.status() == WL_CONNECTED) {\n    HTTPClient http;\n    WiFiClient client;\n\n    StaticJsonDocument<200> doc;\n    JsonArray data = doc.createNestedArray("data");\n',this.arduinos.forEach(i=>{i.sensores.forEach((s,r)=>{const c=s.nome.replace(/\s+/g,"_"),F=c.toUpperCase();e+=`\n    int ${c}Value = analogRead(${F}_PIN);\n    JsonObject sensor${r+1}Data = data.createNestedObject();\n    sensor${r+1}Data["id_sensor"] = ${s.id_sensor};\n    sensor${r+1}Data["valor"] = ${c}Value;\n        `})}),e+='\n    String jsonString;\n    serializeJson(doc, jsonString);\n    Serial.println(jsonString);\n\n    http.begin(serverAddress);\n    http.addHeader("Content-Type", "application/json");\n\n    int httpResponseCode = http.POST(jsonString);\n    if (httpResponseCode > 0) {\n      String response = http.getString();\n      Serial.println(httpResponseCode);\n      Serial.println(response);\n    } else {\n      Serial.print("Erro ao enviar POST: ");\n      Serial.println(httpResponseCode);\n    }\n\n    http.end();\n  }\n  delay(10000);\n}\n',this.generatedCode=e}copyToClipboard(){const e=document.createElement("textarea");e.value=this.generatedCode,document.body.appendChild(e),e.select(),document.execCommand("copy"),document.body.removeChild(e),this.Toast.mostrarToast("success","C\xf3digo copiado para a \xe1rea de transfer\xeancia!")}}return(n=a).\u0275fac=function(e){return new(e||n)(o.rXU(C.u),o.rXU(m.f),o.rXU(f.o),o.rXU(l.nX))},n.\u0275cmp=o.VBU({type:n,selectors:[["app-codigo-arduino"]],decls:14,vars:2,consts:[[3,"fullscreen"],[1,"ion-justify-content-center"],["size","11"],["expand","block","fill","outline","color","dark","size","large",3,"click"],[1,"ion-justify-content-center","ion-margin"],["size","12","sizeMd","11",1,"codigo"]],template:function(e,i){1&e&&(o.j41(0,"ion-content",0),o.nrm(1,"app-header"),o.j41(2,"ion-row",1)(3,"ion-col",2)(4,"ion-button",3),o.bIt("click",function(){return i.copyToClipboard()}),o.EFF(5,"Copiar"),o.k0s()()(),o.j41(6,"ion-row",4)(7,"ion-col",5)(8,"pre"),o.EFF(9,"        "),o.j41(10,"code"),o.EFF(11),o.k0s(),o.EFF(12,"\n      "),o.k0s()()(),o.nrm(13,"app-footer"),o.k0s()),2&e&&(o.Y8G("fullscreen",!0),o.R7$(11),o.SpI("\n        ",i.generatedCode,"\n        "))},dependencies:[u.Jm,u.hU,u.W9,u.ln,A.l,v.n],styles:[".codigo[_ngcontent-%COMP%]{background-color:var(--ion-color-light);border-radius:10px;box-shadow:2px 2px 20px #00000059}"]}),a})()}];let y=(()=>{var n;class a{}return(n=a).\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.$C({type:n}),n.\u0275inj=o.G2t({imports:[l.iI.forChild(P),l.iI]}),a})();var S=t(8178),T=t(2898);let E=(()=>{var n;class a{}return(n=a).\u0275fac=function(e){return new(e||n)},n.\u0275mod=o.$C({type:n}),n.\u0275inj=o.G2t({imports:[p.MD,h.YN,u.bv,y,S.G,T.k]}),a})()}}]);